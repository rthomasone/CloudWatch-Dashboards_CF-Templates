{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "CloudWatch Dashboards to visualize Network Load Balancer (NLB) resources. Both dashboards leverage Dashboard Variables to filter on the desired resources. Dashboard 'NLB_All_Resources' visualizes ALL NLB resources in the target region. Dashboard 'NLB_Individual_Resources' provides additional filters to isolate a specific NLB.",
    "Transform": "AWS::LanguageExtensions",
    "Parameters": {
        "DefaultRegion": {
            "Description": "Select the default region hosting the load balancers to be monitored.",
            "Type": "String",
            "Default": "us-east-1"
        },
        "DefaultNLB": {
            "Description": "Select the default load balancer to be monitored. (e.g. net/nlb-abc/0123456789abcdef)",
            "Type": "String",
            "Default": ""
        }
    },
    "Resources": {
        "CWDashboardALBAll": {
            "Type": "AWS::CloudWatch::Dashboard",
            "Properties": {
                "DashboardName": "NLB_All_Resources",
                "DashboardBody": {
                    "Fn::ToJsonString": {
                        "variables": [
                            {
                                "type": "pattern",
                                "pattern": "us-east-1",
                                "inputType": "select",
                                "id": "Region",
                                "label": "Region",
                                "defaultValue": "us-east-1",
                                "visible": true,
                                "values": [
                                    {
                                        "value": "us-east-1",
                                        "label": "N. Virginia"
                                    },
                                    {
                                        "value": "us-east-2",
                                        "label": "Ohio"
                                    },
                                    {
                                        "value": "us-west-1",
                                        "label": "N.California"
                                    },
                                    {
                                        "value": "us-west-2",
                                        "label": "Oregon"
                                    },
                                    {
                                        "value": "ap-east-1",
                                        "label": "Hong Kong"
                                    },
                                    {
                                        "value": "ap-south-1",
                                        "label": "Mumbai"
                                    },
                                    {
                                        "value": "ap-northeast-3",
                                        "label": "Osaka"
                                    },
                                    {
                                        "value": "ap-northeast-2",
                                        "label": "Seoul"
                                    },
                                    {
                                        "value": "ap-southeast-1",
                                        "label": "Singapore"
                                    },
                                    {
                                        "value": "ap-southeast-2",
                                        "label": "Sydney"
                                    },
                                    {
                                        "value": "ap-noutheast-1",
                                        "label": "Toyko"
                                    },
                                    {
                                        "value": "ca-central-1",
                                        "label": "Canada"
                                    },
                                    {
                                        "value": "eu-central-1",
                                        "label": "Frankfurt"
                                    },
                                    {
                                        "value": "eu-west-1",
                                        "label": "Ireland"
                                    },
                                    {
                                        "value": "eu-west-2",
                                        "label": "London"
                                    },
                                    {
                                        "value": "eu-west-3",
                                        "label": "Paris"
                                    },
                                    {
                                        "value": "eu-north-1",
                                        "label": "Stockholm"
                                    },
                                    {
                                        "value": "sa-east-1",
                                        "label": "South America"
                                    }
                                ],
                                "value": "us-east-1",
                                "customValues": "us-east-1, N. Virginia\nus-east-2, Ohio\nus-west-1, N.California\nca-central-1, Canada\nus-west-2, Oregon\neu-west-1, Ireland\neu-west-2, London\neu-central-1, Frankfurt"
                            }
                        ],
                        "widgets": [
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Target_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Target_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_ELB_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_ELB_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Client_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Client_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 26,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"NewFlowCount\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ],
                                        [
                                            "AWS/NetworkELB",
                                            "NewFlowCount",
                                            "LoadBalancer",
                                            "net/rtaa-nlb/93e01a268cde1cad",
                                            {
                                                "region": "us-east-1",
                                                "id": "m1",
                                                "visible": false
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "NewFlowCount"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 38,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Target Group-Level Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 0,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Load Balancer-Level Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 26,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ActiveFlowCount\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "ActiveFlowCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 26,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"RejectedFlowCount\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "RejectedFlowCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 32,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"SecurityGroupBlockedFlowCount_Inbound_TCP\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "Flows Blocked by Security Groups"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 19,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ProcessedBytes\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "ProcessedBytes"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 13,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PeakBytesPerSecond\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "PeakBytesPerSecond"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 13,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PortAllocationErrorCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "PortAllocationErrorCount"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 25,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Flow Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 39,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"HealthyHostCount\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')} ${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Minimum",
                                    "period": 60,
                                    "title": "HealthyHostCount Targets by ALB & Target Group"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 39,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"UnHealthyHostCount\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')} ${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Maximum",
                                    "period": 60,
                                    "title": "Unhealthy Targets by NLB & Target Group",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 39,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"UnHealthyHostCount\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')} ${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Maximum",
                                    "period": 60,
                                    "title": "Unhealthy Targets by NLB & Target Group"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 19,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PortAllocationErrorCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "PortAllocationErrorCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 1,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Client_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Client_Reset_Count",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 45,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### TLS Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 52,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Zonal Shift Metrics Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 46,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ClientTLSNegotiationErrorCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "Client-side TLS Negotiation Errors"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 46,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TargetTLSNegotiationErrorCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "Target-side TLS Negotiation Errors"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 53,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ZonalHealthStatus\"', 'Minimum', 60), MIN, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "ZonalHealthStatus"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 53,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"ActiveZonalShiftHostCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "ActiveZonalShiftHostCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 13,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ProcessedBytes\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "ProcessedBytes",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 32,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"UnhealthyRoutingFlowCount\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "UnhealthyRoutingFlowCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 1,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Target_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e3",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Target_Reset_Count",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 1,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_ELB_Reset_Count\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.LoadBalancer')}",
                                                "id": "e2",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_ELB_Reset_Count",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            }
                        ]
                    }
                }
            }
        },
        "CWDashboardALBIndividual": {
            "Type": "AWS::CloudWatch::Dashboard",
            "Properties": {
                "DashboardName": "NLB_Individual_Resources",
                "DashboardBody": {
                    "Fn::ToJsonString": {
                        "variables": [
                            {
                                "type": "pattern",
                                "pattern": "us-east-1",
                                "inputType": "select",
                                "id": "Region",
                                "label": "Region",
                                "defaultValue": "us-east-1",
                                "visible": true,
                                "values": [
                                    {
                                        "value": "us-east-1",
                                        "label": "N. Virginia"
                                    },
                                    {
                                        "value": "us-east-2",
                                        "label": "Ohio"
                                    },
                                    {
                                        "value": "us-west-1",
                                        "label": "N.California"
                                    },
                                    {
                                        "value": "us-west-2",
                                        "label": "Oregon"
                                    },
                                    {
                                        "value": "ap-east-1",
                                        "label": "Hong Kong"
                                    },
                                    {
                                        "value": "ap-south-1",
                                        "label": "Mumbai"
                                    },
                                    {
                                        "value": "ap-northeast-3",
                                        "label": "Osaka"
                                    },
                                    {
                                        "value": "ap-northeast-2",
                                        "label": "Seoul"
                                    },
                                    {
                                        "value": "ap-southeast-1",
                                        "label": "Singapore"
                                    },
                                    {
                                        "value": "ap-southeast-2",
                                        "label": "Sydney"
                                    },
                                    {
                                        "value": "ap-noutheast-1",
                                        "label": "Toyko"
                                    },
                                    {
                                        "value": "ca-central-1",
                                        "label": "Canada"
                                    },
                                    {
                                        "value": "eu-central-1",
                                        "label": "Frankfurt"
                                    },
                                    {
                                        "value": "eu-west-1",
                                        "label": "Ireland"
                                    },
                                    {
                                        "value": "eu-west-2",
                                        "label": "London"
                                    },
                                    {
                                        "value": "eu-west-3",
                                        "label": "Paris"
                                    },
                                    {
                                        "value": "eu-north-1",
                                        "label": "Stockholm"
                                    },
                                    {
                                        "value": "sa-east-1",
                                        "label": "South America"
                                    }
                                ],
                                "value": "us-east-1",
                                "customValues": "us-east-1, N. Virginia\nus-east-2, Ohio\nus-west-1, N.California\nca-central-1, Canada\nus-west-2, Oregon\neu-west-1, Ireland\neu-west-2, London\neu-central-1, Frankfurt"
                            },
                            {
                                "type": "property",
                                "property": "LoadBalancer",
                                "inputType": "select",
                                "id": "LoadBalancer",
                                "label": "LoadBalancer",
                                "defaultValue": "net/rtaa-nlb/93e01a268cde1cad",
                                "visible": true,
                                "search": "{AWS/NetworkELB,LoadBalancer}",
                                "populateFrom": "LoadBalancer"
                            }
                        ],
                        "widgets": [
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Target_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Target_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_ELB_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_ELB_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 7,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Client_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Client_Reset_Count"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 20,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} NewFlowCount LoadBalancer=\"appname\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "New Flows"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 32,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Target Group-Level Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 0,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Load Balancer-Level Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 20,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} ActiveFlowCount LoadBalancer=\"appname\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "Active Flows"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 20,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=RejectedFlowCount LoadBalancer=\"appname\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 60,
                                    "stat": "Sum",
                                    "title": "Rejected Flows"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 26,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} SecurityGroupBlockedFlowCount LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "Flows Blocked by Security Groups"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 13,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "SORT(REMOVE_EMPTY(SEARCH('{AWS/NetworkELB,LoadBalancer} ProcessedBytes LoadBalancer=\"appname\"', 'Sum', 60)), SUM, DESC)",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "ProcessedBytes"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 13,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PeakBytesPerSecond\" LoadBalancer=\"appname\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Maximum",
                                    "period": 60,
                                    "title": "PeakBytesPerSecond"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 5,
                                "y": 1,
                                "width": 5,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PortAllocationErrorCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "PortAllocationErrorCount"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 19,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Flow Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 16,
                                "y": 33,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"HealthyHostCount\" LoadBalancer=\"appname\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Minimum",
                                    "period": 60,
                                    "title": "Healthy Targets"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 33,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"UnHealthyHostCount\" LoadBalancer=\"appname\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Maximum",
                                    "period": 60,
                                    "title": "Unhealthy Targets"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 33,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"UnHealthyHostCount\" LoadBalancer=\"appname\"', 'Maximum', 60), MAX, DESC))",
                                                "label": "${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Maximum",
                                    "period": 60,
                                    "title": "Unhealthy Targets"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 10,
                                "y": 1,
                                "width": 14,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"PortAllocationErrorCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "PortAllocationErrorCount"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 39,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### TLS Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 40,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TargetTLSNegotiationErrorCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "Target-side TLS Negotiation Errors"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 40,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ClientTLSNegotiationErrorCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "Client-side TLS Negotiation Errors"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 1,
                                "width": 5,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Client_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ],
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_ELB_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e3",
                                                "region": "us-east-1"
                                            }
                                        ],
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"TCP_Target_Reset_Count\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e2",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "singleValue",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "stat": "Sum",
                                    "period": 60,
                                    "title": "TCP_Reset_Count",
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 26,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"UnhealthyRoutingFlowCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "UnhealthyRoutingFlowCount"
                                }
                            },
                            {
                                "type": "text",
                                "x": 0,
                                "y": 46,
                                "width": 24,
                                "height": 1,
                                "properties": {
                                    "markdown": "### Zonal Shift Metrics",
                                    "background": "transparent"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 8,
                                "y": 47,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,TargetGroup,LoadBalancer} MetricName=\"ActiveZonalShiftHostCount\" LoadBalancer=\"appname\"', 'Sum', 60), SUM, DESC))",
                                                "label": "${PROP('Dim.TargetGroup')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "ActiveZonalShiftHostCount"
                                }
                            },
                            {
                                "type": "metric",
                                "x": 0,
                                "y": 47,
                                "width": 8,
                                "height": 6,
                                "properties": {
                                    "metrics": [
                                        [
                                            {
                                                "expression": "REMOVE_EMPTY(SORT(SEARCH('{AWS/NetworkELB,LoadBalancer} MetricName=\"ZonalHealthStatus\" LoadBalancer=\"appname\"', 'Minimum', 60), MIN, DESC))",
                                                "label": "${PROP('MetricName')}",
                                                "id": "e1",
                                                "region": "us-east-1"
                                            }
                                        ]
                                    ],
                                    "view": "timeSeries",
                                    "stacked": false,
                                    "region": "us-east-1",
                                    "period": 300,
                                    "setPeriodToTimeRange": true,
                                    "sparkline": false,
                                    "stat": "Average",
                                    "title": "ZonalHealthStatus"
                                }
                            }
                        ]
                    }
                }
            }
        }
    }
}